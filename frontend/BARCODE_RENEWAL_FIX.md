# ุชุตุญูุญ ูุธุงู ุชุฌุฏูุฏ ุงูุจุงุฑููุฏุงุช ูุนุฑุถ ุงููุญุงุถุฑุงุช

## ๐ ุงููุดุงูู ุงูุชู ุชู ุญููุง

### 1. ุชุฌุฏูุฏ ุงูุจุงุฑููุฏุงุช ููููุงู โ

**ุงููุดููุฉ:**
- ุงูุจุงุฑููุฏุงุช ูุงูุช ุชููุดุฃ ูุฑุฉ ูุงุญุฏุฉ ููุง ุชุชุฌุฏุฏ ุชููุงุฆูุงู
- ุงูุจุงุฑููุฏ ููุชูู ุจุนุฏ ููุช ุงูุชูุงุก ุงููุญุงุถุฑุฉ ููุง ูุฌุฏุฏ ูู ุงูููู ุงูุชุงูู

**ุงูุญู:**
- โ ุฅุถุงูุฉ ุฏุงูุฉ `renewBarcodeIfNeeded()` ุงูุชู ุชุชุญูู ูู ุงูููู ูุชุฌุฏุฏ ุงูุจุงุฑููุฏ ุชููุงุฆูุงู
- โ ุชุญุฏูุซ `POST /api/barcodes/scan` ูุชุฌุฏูุฏ ุงูุจุงุฑููุฏ ุนูุฏ ุงููุณุญ ุฅุฐุง ูุฒู ุงูุฃูุฑ
- โ ุชุญุฏูุซ `POST /api/attendance/barcode` ูุชุฌุฏูุฏ ุงูุจุงุฑููุฏ ุนูุฏ ุชุณุฌูู ุงูุญุถูุฑ
- โ ุฅุถุงูุฉ route ุฌุฏูุฏ `POST /api/barcodes/renew-daily` ูุชุฌุฏูุฏ ุฌููุน ุงูุจุงุฑููุฏุงุช
- โ ุฅุถุงูุฉ Cron Jobs ูุชุฌุฏูุฏ ุงูุจุงุฑููุฏุงุช ุชููุงุฆูุงู:
  - ูู ููู ูู ุงูุณุงุนุฉ 12:00 ุตุจุงุญุงู
  - ูู ุณุงุนุฉ (ูููุญุงุถุฑุงุช ุงููุงุฏูุฉ ุฎูุงู ุณุงุนุฉ)

### 2. ุนุฑุถ ุงููุญุงุถุฑุงุช ูู ุงูุฌุฏูู ูู ุงูุชุทุจูู โ

**ุงููุดููุฉ:**
- ูุฏ ูุง ุชุธูุฑ ุงููุญุงุถุฑุงุช ุจุดูู ุตุญูุญ ูู ุงูุฌุฏูู
- ุนุฏู ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ูุจู ุงูุนุฑุถ

**ุงูุญู:**
- โ ุฅุถุงูุฉ ุชุญูู ูู ูุฌูุฏ `week_schedule` ููููู array
- โ ุชุตููุฉ ุงููุญุงุถุฑุงุช ุงููุงุฑุบุฉ ูุจู ุงูุนุฑุถ
- โ ุฅุถุงูุฉ ููู ุงูุชุฑุงุถูุฉ ูููุญุงุถุฑุงุช ุงููุงูุตุฉ
- โ ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

## ๐ง ุงูุชุบููุฑุงุช ุงูููุฌุฒุฉ

### 1. Server - Barcodes Routes (`server/routes/barcodes.js`)

#### ุฏูุงู ูุณุงุนุฏุฉ ุฌุฏูุฏุฉ:
```javascript
// ุงูุญุตูู ุนูู ุงุณู ุงูููู ุจุงูุนุฑุจูุฉ
const getTodayInArabic = () => { ... }

// ุญุณุงุจ ููุช ุงูุชูุงุก ุงููุญุงุถุฑุฉ ููููู ุงูุญุงูู
const calculateExpiryTime = (dayOfWeek, endTime) => { ... }

// ุชุฌุฏูุฏ ุงูุจุงุฑููุฏ ุฅุฐุง ูุฒู ุงูุฃูุฑ
const renewBarcodeIfNeeded = async (barcodeDoc) => { ... }
```

#### Routes ูุญุฏุซุฉ:
- **POST /api/barcodes/scan**: ุชุฌุฏูุฏ ุชููุงุฆู ุนูุฏ ุงููุณุญ
- **POST /api/barcodes/renew-daily**: ุชุฌุฏูุฏ ุฌููุน ุงูุจุงุฑููุฏุงุช (ุฌุฏูุฏ)

### 2. Server - Attendance Routes (`server/routes/attendance.js`)

- โ ุฅุถุงูุฉ ููุณ ุฏูุงู ุงูุชุฌุฏูุฏ
- โ ุชุฌุฏูุฏ ุงูุจุงุฑููุฏ ุนูุฏ ุชุณุฌูู ุงูุญุถูุฑ

### 3. Server - Main Server (`server/server.js`)

- โ ุฅุถุงูุฉ `node-cron` ูุชุดุบูู ุงูููุงู ุงููุฌุฏููุฉ
- โ Cron Job ูููู (12:00 ุตุจุงุญุงู)
- โ Cron Job ูู ุณุงุนุฉ

### 4. Mobile App - Schedule Screen (`app/(tabs)/schedule.tsx`)

- โ ุชุญุณูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช
- โ ุงูุชุญูู ูู ุตุญุฉ `week_schedule`
- โ ุชุตููุฉ ุงููุญุงุถุฑุงุช ุงููุงุฑุบุฉ
- โ ุฅุถุงูุฉ ููู ุงูุชุฑุงุถูุฉ
- โ ุฅุตูุงุญ TypeScript errors

### 5. Dependencies (`server/package.json`)

- โ ุฅุถุงูุฉ `node-cron`: ^3.0.3
- โ ุฅุถุงูุฉ `axios`: ^1.6.0

## ๐ฏ ููู ูุนูู ุงููุธุงู ุงูุขู

### ุชุฌุฏูุฏ ุงูุจุงุฑููุฏุงุช:

1. **ุนูุฏ ูุณุญ ุงูุจุงุฑููุฏ:**
   - ุงููุธุงู ูุชุญูู ูู ุงูููู ุงูุญุงูู
   - ุฅุฐุง ูุงู ุงูููู ูู ููู ุงููุญุงุถุฑุฉ
   - ูุฅุฐุง ุงูุชูู ุงูุจุงุฑููุฏ ุฃู ุณููุชูู ุฎูุงู ุณุงุนุฉ
   - ูุชู ุชุฌุฏูุฏู ุชููุงุฆูุงู

2. **ุนูุฏ ุชุณุฌูู ุงูุญุถูุฑ:**
   - ููุณ ุงูููุทู - ุชุฌุฏูุฏ ุชููุงุฆู ุฅุฐุง ูุฒู ุงูุฃูุฑ

3. **ุชุฌุฏูุฏ ูููู ุชููุงุฆู:**
   - Cron Job ูุนูู ูู ููู ูู 12:00 ุตุจุงุญุงู
   - ูุฌุฏูุฏ ุฌููุน ุงูุจุงุฑููุฏุงุช ูููุญุงุถุฑุงุช ูู ุงูููู ุงูุญุงูู

4. **ุชุฌุฏูุฏ ูู ุณุงุนุฉ:**
   - Cron Job ูุนูู ูู ุณุงุนุฉ
   - ูุฌุฏูุฏ ุงูุจุงุฑููุฏุงุช ูููุญุงุถุฑุงุช ุงููุงุฏูุฉ ุฎูุงู ุณุงุนุฉ

### ุนุฑุถ ุงููุญุงุถุฑุงุช:

1. **ุฌูุจ ุงูุฌุฏูู:**
   - `api.schedules.getStudent()` ูุฌูุจ ุฌุฏูู ุงูุทุงูุจ
   - ุญุณุจ `department_id` ู `year_level`

2. **ูุนุงูุฌุฉ ุงูุจูุงูุงุช:**
   - ุงูุชุญูู ูู ูุฌูุฏ `week_schedule`
   - ุงูุจุญุซ ุนู ุงูููู ุงููุญุฏุฏ
   - ุชุตููุฉ ุงููุญุงุถุฑุงุช ุงููุงุฑุบุฉ
   - ุชุฑุชูุจ ุญุณุจ ููุช ุงูุจุฏุก

3. **ุงูุนุฑุถ:**
   - ุนุฑุถ ุงููุญุงุถุฑุงุช ูุน ุฌููุน ุงูุชูุงุตูู
   - ุฅุธูุงุฑ ุงููุญุงุถุฑุฉ ุงูุฌุงุฑูุฉ ุญุงููุงู
   - ุฅุธูุงุฑ ุงููุญุงุถุฑุงุช ุงููุงุฏูุฉ

## ๐ ูุซุงู ุนูู ุชุฌุฏูุฏ ุงูุจุงุฑููุฏ

```javascript
// ูุจู ุงูุชุฌุฏูุฏ
{
  expiry_time: "2024-01-15T10:00:00.000Z", // ุงูุชูู
  lecture_info: {
    day_of_week: "ุงูุณุจุช",
    end_time: "10:00"
  }
}

// ุจุนุฏ ุงูุชุฌุฏูุฏ (ุฅุฐุง ูุงู ุงูููู ูู ุงูุณุจุช)
{
  expiry_time: "2024-01-20T10:00:00.000Z", // ุฌุฏูุฏ ููููู ุงูุญุงูู
  lecture_info: {
    day_of_week: "ุงูุณุจุช",
    end_time: "10:00"
  }
}
```

## ๐ ุงููููุงุช ุงููุญุฏุซุฉ

1. `server/routes/barcodes.js` - ุฏูุงู ุงูุชุฌุฏูุฏ + route ุฌุฏูุฏ
2. `server/routes/attendance.js` - ุชุฌุฏูุฏ ุนูุฏ ุชุณุฌูู ุงูุญุถูุฑ
3. `server/server.js` - Cron Jobs
4. `server/package.json` - ุฅุถุงูุฉ dependencies
5. `app/(tabs)/schedule.tsx` - ุชุญุณูู ุนุฑุถ ุงููุญุงุถุฑุงุช

## ๐ ููุงุญุธุงุช ูููุฉ

- ุงูุจุงุฑููุฏุงุช ุชุชุฌุฏุฏ ุชููุงุฆูุงู ูู ููู ุงููุญุงุถุฑุฉ
- ูุง ุญุงุฌุฉ ูุชุฌุฏูุฏ ูุฏูู ููุจุงุฑููุฏุงุช
- Cron Jobs ุชุนูู ุชููุงุฆูุงู ุนูุฏ ุชุดุบูู ุงูุณูุฑูุฑ
- ูููู ุงุณุชุฏุนุงุก `/api/barcodes/renew-daily` ูุฏููุงู ุฅุฐุง ูุฒู ุงูุฃูุฑ

## ๐ง ุงูุชุซุจูุช

```bash
cd server
npm install node-cron axios
```

## โ ุงููุชูุฌุฉ

- โ ุงูุจุงุฑููุฏุงุช ุชุชุฌุฏุฏ ููููุงู ุชููุงุฆูุงู
- โ ุงูุจุงุฑููุฏุงุช ุชุชุฌุฏุฏ ุนูุฏ ุงููุณุญ ุฅุฐุง ูุฒู ุงูุฃูุฑ
- โ ุนุฑุถ ุงููุญุงุถุฑุงุช ูุญุณูู ููุณุชูุฑ
- โ ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก ูุงูุจูุงูุงุช ุงููุงูุตุฉ






